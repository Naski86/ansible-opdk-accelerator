---
- name: Validate that port requirements are met
  hosts: ms
  vars:
    test_port: 1234
  vars_files:
  -  port-list.yml
  tasks:
  - name: Setup listener
    shell: "nc -l -p {{ test_port }}"
    register: listener_ps

  - name: Validate port
    wait_for:
      port: "{{ test_port }}"
      timeout: 2

